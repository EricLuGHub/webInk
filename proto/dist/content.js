const f="test";let i=null,n=null,r=null,a=null;function h(e){if(!e)return!1;if(e instanceof HTMLTextAreaElement)return!0;if(e instanceof HTMLInputElement){const t=(e.type||"").toLowerCase();return t==="password"||t==="hidden"||e.readOnly||e.disabled?!1:["text","search","email","url","tel","number"].includes(t)||t===""}if(e instanceof HTMLElement){const t=e.getAttribute("contenteditable");return(t===""||t==="true")&&!e.hasAttribute("aria-hidden")}return!1}function g(){n||(n=document.createElement("div"),n.style.position="absolute",n.style.pointerEvents="none",n.style.zIndex="2147483647",n.style.whiteSpace="pre-wrap",n.style.visibility="hidden",n.style.overflow="hidden",document.documentElement.appendChild(n)),r||(r=document.createElement("div"),r.style.position="absolute",r.style.pointerEvents="none",r.style.zIndex="2147483647",r.style.whiteSpace="pre",r.style.visibility="hidden",document.documentElement.appendChild(r))}function p(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function m(e,t){const o=getComputedStyle(e),s=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","lineHeight","textTransform","textDecoration","wordBreak","overflowWrap","textAlign"];for(const l of s)t.style.setProperty(l,o.getPropertyValue(l));t.style.color=o.color,t.style.padding=`${o.paddingTop} ${o.paddingRight} ${o.paddingBottom} ${o.paddingLeft}`,t.style.boxSizing=o.boxSizing,t.style.background="transparent",t.style.borderRadius=o.borderRadius}function v(e){const t=e.selectionStart??e.value.length,o=e.selectionEnd??e.value.length;return t===o&&t===e.value.length}function T(e){if(!n)return;const t=e.getBoundingClientRect();if(n.style.left=`${t.left+window.scrollX}px`,n.style.top=`${t.top+window.scrollY}px`,n.style.width=`${t.width}px`,n.style.height=`${t.height}px`,m(e,n),n.style.whiteSpace=e instanceof HTMLTextAreaElement?"pre-wrap":"pre",!v(e)){n.style.visibility="hidden",n.innerHTML="";return}const o=p(e.value),s=getComputedStyle(e).color;n.innerHTML=`<span style="color:transparent;-webkit-text-fill-color:transparent">${o}</span><span style="opacity:.45;color:${s}">${p(f)}</span>`,n.style.visibility="visible",n.scrollTop=e.scrollTop,n.scrollLeft=e.scrollLeft}function E(e){const t=document.getSelection();if(!t||!t.rangeCount)return null;const o=t.getRangeAt(0);if(!e.contains(o.startContainer))return null;const s=o.cloneRange();return s.collapse(!0),s.getClientRects()[0]||s.getBoundingClientRect()||null}function w(e){if(!r)return;const t=E(e);if(!t){r.style.visibility="hidden",r.innerHTML="";return}m(e,r),r.style.left=`${t.left+window.scrollX}px`,r.style.top=`${t.top+window.scrollY}px`,r.innerHTML=`<span style="opacity:.45;color:${getComputedStyle(e).color}">${p(f)}</span>`,r.style.visibility="visible"}function u(){if(!i){n&&(n.style.visibility="hidden"),r&&(r.style.visibility="hidden");return}i instanceof HTMLInputElement||i instanceof HTMLTextAreaElement?(r&&(r.style.visibility="hidden"),T(i)):(n&&(n.style.visibility="hidden"),w(i))}function L(){if(a!==null)return;const e=()=>{u(),a=requestAnimationFrame(e)};a=requestAnimationFrame(e)}function y(){a!==null&&(cancelAnimationFrame(a),a=null)}function x(e){const t=e.target;i=h(t)?t:null,g(),i?L():y()}function S(e){const t=e.target;i&&t===i&&(i=null,y(),u())}function C(){if(!i)return!1;if(i instanceof HTMLInputElement||i instanceof HTMLTextAreaElement)return v(i);const e=document.getSelection();if(!e||!e.rangeCount)return!1;const t=e.getRangeAt(0);return i.contains(t.startContainer)}async function A(e,t){for(const o of t){const s=e.selectionStart??e.value.length,l=e.selectionEnd??e.value.length;e.setRangeText(o,s,l,"end");const c=new InputEvent("input",{bubbles:!0,inputType:"insertText",data:o});e.dispatchEvent(c),await new Promise(b=>setTimeout(b,8))}}async function H(e,t){for(const o of t){if(!document.execCommand("insertText",!1,o)){const l=document.getSelection();if(!l||!l.rangeCount)return;const c=l.getRangeAt(0);c.deleteContents(),c.insertNode(document.createTextNode(o)),c.collapse(!1)}e.dispatchEvent(new InputEvent("input",{bubbles:!0,inputType:"insertText",data:o})),await new Promise(l=>setTimeout(l,8))}}async function I(){i&&(i instanceof HTMLInputElement||i instanceof HTMLTextAreaElement?await A(i,f):await H(i,f))}function M(e){if(e.key==="Tab"&&C()){e.preventDefault(),I().then(()=>u());return}}function d(){i&&u()}g();addEventListener("focusin",x,!0);addEventListener("blur",S,!0);addEventListener("keydown",M,!0);addEventListener("input",d,!0);addEventListener("click",d,!0);addEventListener("scroll",d,!0);addEventListener("resize",d,!0);document.addEventListener("selectionchange",d,!0);new MutationObserver(()=>{i&&!document.contains(i)&&(i=null,y(),u())}).observe(document.documentElement,{childList:!0,subtree:!0});
